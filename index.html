<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tecla Premium - Dashboard Técnico</title>
    <!-- Incluindo Font Awesome para ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* --- VARIÁVEIS CSS (PALETA TECLA) --- */
        :root {
            --color-primary: #4B9CD3; /* Azul Tecla (Cabeçalho, Botões) */
            --color-background-soft: #FFF9F0; /* Creme Acolhedor (Fundo principal) */
            --color-background-white: #FFFFFF; /* Branco (Container Principal) */
            --color-text: #222222; /* Texto Padrão */
            --color-dark-menu: #1e2a38; /* Fundo Menu Lateral */
            --color-alert: #A00000; /* Texto de Alerta */
            --color-alert-bg: #FFEBEB; /* Fundo de Alerta */
            --color-success: #2ecc71; /* Cor para sucesso/positivo */

            /* --- VARIÁVEIS DE LAYOUT E ESPAÇAMENTO --- */
            --spacing-large: 25px;
            --spacing-medium: 15px;
            --border-radius-large: 18px;
            --border-radius-medium: 10px;
            --shadow-soft: 0 8px 30px rgba(0,0,0,0.05);
        }

        /* --- BASE E TIPOGRAFIA --- */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Verdana', 'Open Sans', sans-serif;
            background: var(--color-background-soft);
            color: var(--color-text);
            line-height: 1.6;
            font-size: 16px;
        }

        /* --- SIDEBAR (MENU LATERAL FIXO) --- */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100%;
            background: var(--color-dark-menu);
            color: white;
            padding: 30px 20px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.3);
            z-index: 50;
            box-sizing: border-box;
        }
        .sidebar h2 {
            color: #bfe0ff;
            text-align: left;
            margin-top: 0;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 15px;
            font-weight: bold;
        }
        .sidebar a {
            display: block;
            padding: 12px var(--spacing-medium);
            color: #bfe0ff;
            text-decoration: none;
            margin: 8px 0;
            border-radius: var(--border-radius-medium);
            transition: background 0.2s, color 0.2s;
        }
        .sidebar a:hover, .sidebar a.active {
            background: #2c3e50;
            color: white;
        }

        /* --- CONTEÚDO PRINCIPAL --- */
        .main-content {
            margin-left: 250px; /* Espaço para o menu lateral */
            padding: 20px;
            padding-top: 40px;
        }

        /* --- CABEÇALHO DO MAIN (DASHBOARD HEADER) --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-large);
            padding: 10px 0;
            border-bottom: 2px solid #EEE;
        }
        .header h1 {
            margin: 0;
            font-size: 1.8em;
            color: var(--color-primary);
        }
        .header div {
            font-size: 1.1em;
            font-weight: 600;
            color: #555;
        }

        /* --- LAYOUT DO PAINEL DE CONTROLE (NOVO: COLUNAS) --- */
        .dashboard-layout {
            display: flex;
            gap: var(--spacing-large);
            margin-bottom: var(--spacing-large);
        }

        .left-column {
            flex: 2; /* 2/3 da largura */
            min-width: 0;
        }
        
        .right-column {
            flex: 1; /* 1/3 da largura */
            min-width: 0;
        }

        /* --- MINI-CARDS DE RESUMO (NOVO) --- */
        .mini-card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--spacing-medium);
            margin-bottom: var(--spacing-large);
        }
        .mini-card {
            background: var(--color-background-white);
            padding: var(--spacing-medium);
            border-radius: var(--border-radius-medium);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            text-align: center;
            border: 1px solid #EFEFEF;
        }
        .mini-card p {
            margin: 5px 0 0 0;
            font-size: 0.9em;
            color: #666;
        }
        .mini-card .value {
            font-size: 2.2em;
            font-weight: bold;
            margin: 0;
            line-height: 1.2;
        }

        /* --- CARDS E ALERTA (Geral) --- */
        .card {
            background: var(--color-background-white);
            padding: var(--spacing-large);
            border-radius: var(--border-radius-medium);
            margin-bottom: var(--spacing-large);
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: box-shadow 0.3s;
        }
        .card h3 {
            border-bottom: 1px solid #EEE;
            padding-bottom: 10px;
            margin-top: 0;
            color: #333;
        }
        .alert {
            padding: var(--spacing-medium);
            background: var(--color-alert-bg);
            color: var(--color-alert);
            margin-bottom: var(--spacing-medium);
            border-radius: var(--border-radius-medium);
            border-left: 8px solid #FF5A5A; /* Alerta de Crise */
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(255,90,90,0.1);
        }

        /* --- TABELA (LOGS) --- */
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #F0F0F0;
        }
        th {
            background: #fcfcfc;
            font-weight: 600;
            color: #555;
            text-transform: uppercase;
            font-size: 0.9em;
        }
        tr:nth-child(even) {
            background-color: #f7faff; /* Listras suaves */
        }
        /* Cor de destaque para o Alerta na tabela e no resumo */
        .alerta-true {
            color: var(--color-alert);
            font-weight: bold;
        }
        .valor-interacoes { color: var(--color-primary); }
        .valor-alerta { color: var(--color-alert); }
        .valor-emocao { color: var(--color-success); }


        /* --- RESPONSIVIDADE (MOBILE / TABLET) --- */
        @media (max-width: 900px) {
            .sidebar {
                position: static; 
                width: 100%;
                height: auto;
                padding: 15px 20px;
                box-shadow: 0 4px 10px rgba(0,0,0,0.1);
                display: flex;
                flex-wrap: wrap;
                align-items: center;
                gap: 10px;
            }
            .sidebar h2 {
                border-bottom: none;
                padding-bottom: 0;
                margin-bottom: 0;
                flex-shrink: 0;
            }
            .sidebar a {
                display: inline-block;
                margin: 5px;
                padding: 8px 12px;
                font-size: 0.9em;
                background: #2c3e50;
            }
            .main-content {
                margin-left: 0;
                padding-top: 20px;
            }
            
            /* Colunas do Dashboard se empilham em telas pequenas */
            .dashboard-layout {
                flex-direction: column;
            }

            /* Ajuste para rolagem horizontal em tabelas (se necessário) */
            .card table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>

<!-- SIDEBAR (Menu de Navegação do Dashboard) -->
<div class="sidebar">
    <h2><i class="fas fa-brain"></i> Tecla Premium</h2>
    <a href="#dashboard" class="active"><i class="fas fa-chart-line"></i> Dashboard</a>
    <a href="#logs"><i class="fas fa-list-ul"></i> Logs</a>
    <a href="#graficos"><i class="fas fa-chart-pie"></i> Gráficos</a>
    <a href="#usuarios"><i class="fas fa-users"></i> Usuários</a>
    <a href="#config"><i class="fas fa-cogs"></i> Configurações</a>
</div>

<!-- CONTEÚDO PRINCIPAL DO DASHBOARD -->
<div class="main-content">
    <div class="header">
        <h1>Dashboard Técnico</h1>
        <div><i class="fas fa-user-circle"></i> Terapeuta</div>
    </div>

    <!-- Alertas (Topo) -->
    <div id="alertas"></div>

    <!-- Mini-Cards de Resumo -->
    <div class="mini-card-grid" id="dashboard">
        <!-- Total de Interações -->
        <div class="mini-card">
            <p>Total de Interações</p>
            <p class="value valor-interacoes" id="totalInteracoes">0</p>
        </div>

        <!-- Alertas de Risco -->
        <div class="mini-card">
            <p>Alertas de Risco Hoje</p>
            <p class="value valor-alerta" id="totalAlertas">0</p>
        </div>

        <!-- Emoção Predominante (Este será preenchido pelo JS) -->
        <div class="mini-card">
            <p>Emoção Principal</p>
            <p class="value valor-emocao" id="emocaoPrincipal">--</p>
        </div>
    </div>

    <!-- Layout de Colunas (Gráficos e Logs) -->
    <div class="dashboard-layout">
        
        <div class="left-column">
            <!-- Logs detalhados (Prioridade maior na coluna da esquerda) -->
            <div class="card" id="logs">
                <h3><i class="fas fa-book-open"></i> Logs Detalhados</h3>
                <table>
                    <thead>
                        <tr><th>Horário</th><th>Frase</th><th>Categoria</th><th>Alerta</th></tr>
                    </thead>
                    <tbody id="tabelaLogs"></tbody>
                </table>
            </div>
        </div>

        <div class="right-column">
            <!-- Gráfico de Emoções (Prioridade menor na coluna da direita) -->
            <div class="card" id="graficos">
                <h3><i class="fas fa-smile-beam"></i> Emoções Predominantes</h3>
                <canvas id="graficoEmocoes"></canvas>
            </div>
        </div>
    </div>

</div>

<!-- Chart.js CDN (Necessário para o gráfico) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Dados simulados
    const dadosLogs = [
        {hora:'08:15', frase:'Quero brincar', categoria:'Brincar', alerta:false},
        {hora:'09:05', frase:'Estou triste', categoria:'Emoção', alerta:true},
        {hora:'11:30', frase:'Preciso ir ao banheiro', categoria:'Necessidade', alerta:false},
        {hora:'13:45', frase:'Estou feliz!', categoria:'Emoção', alerta:false},
        {hora:'15:10', frase:'Quero comer', categoria:'Necessidade', alerta:false},
        {hora:'16:20', frase:'Gostei muito disso', categoria:'Emoção', alerta:false},
    ];

    const emocaoCounts = {Feliz:3, Triste:1, Neutra:1, Brincar:1}; // Dados mais ricos

    // Função para encontrar a emoção principal
    function getEmocaoPrincipal(counts) {
        let maxCount = 0;
        let principal = '--';
        for (const [emocao, count] of Object.entries(counts)) {
            if (count > maxCount) {
                maxCount = count;
                principal = emocao;
            }
        }
        return principal;
    }

    // Inserir logs
    const tabela = document.getElementById('tabelaLogs');
    dadosLogs.forEach(log => {
        const tr = document.createElement('tr');
        // Usando a classe 'alerta-true' para formatar o ícone de alerta
        const alertaDisplay = log.alerta 
            ? `<span class="alerta-true"><i class="fas fa-exclamation-triangle"></i></span>` 
            : '';
        
        tr.innerHTML = `
            <td>${log.hora}</td>
            <td>${log.frase}</td>
            <td>${log.categoria}</td>
            <td>${alertaDisplay}</td>
        `;
        tabela.appendChild(tr);
    });

    // Atualizar resumo (Mini-Cards)
    document.getElementById('totalInteracoes').innerText = dadosLogs.length;
    document.getElementById('totalAlertas').innerText = dadosLogs.filter(l => l.alerta).length;
    document.getElementById('emocaoPrincipal').innerText = getEmocaoPrincipal(emocaoCounts);

    // Alertas no topo
    const alertasDiv = document.getElementById('alertas');
    dadosLogs.filter(l => l.alerta).forEach(a => {
        const div = document.createElement('div');
        div.className = 'alert';
        div.innerHTML = `⚠️ **Alerta de Risco Detectado:** A criança expressou **"${a.frase}"** às ${a.hora}.`;
        alertasDiv.appendChild(div);
    });

    // Gráfico de emoções
    const ctx = document.getElementById('graficoEmocoes').getContext('2d');
    new Chart(ctx, {
        type: 'doughnut', /* Alterado para Donut Chart para um visual mais limpo */
        data: {
            labels: Object.keys(emocaoCounts),
            datasets: [{
                label: 'Contagem de Emoções',
                data: Object.values(emocaoCounts),
                // Cores suaves e amigáveis, alinhadas ao design Tecla
                backgroundColor: ['#2ecc71', '#e74c3c', '#f1c40f', '#4B9CD3', '#9b59b6', '#3498db'], 
                hoverOffset: 4
            }]
        },
        options: { 
            responsive: true,
            aspectRatio: 1, /* Mantém proporção quadrada */
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        font: {
                            size: 14
                        }
                    }
                },
                tooltip: {
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    titleFont: { size: 16 },
                    bodyFont: { size: 14 }
                }
            }
        }
    });
</script>

</body>
</html>
