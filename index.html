<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tecla Premium</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- MENU LATERAL (3 BARRAS) -->
  <div id="menuIcon" onclick="toggleMenu()">â˜°</div>

  <nav id="sideMenu">
    <h2>ğŸ“ VersÃµes da Tecla</h2>
    <ul>
      <li><a href="#" onclick="abrirVersao('lite')">ğŸŸ¦ Tecla Lite (GrÃ¡tis)</a></li>
      <li><a href="#" onclick="abrirVersao('standard')">ğŸŸ© Tecla Standard</a></li>
      <li><a href="#" onclick="abrirVersao('premium')">ğŸŸ¨ Tecla Premium (Atual)</a></li>
      <li><a href="#" onclick="abrirVersao('future-ai')">ğŸŸ¥ Tecla Neural Future</a></li>
    </ul>
  </nav>

  <!-- CABEÃ‡ALHO -->
  <header>
    <h1>ğŸ§  Tecla Premium</h1>
    <p>Assistente cognitivo avanÃ§ado para autistas â€” comunicaÃ§Ã£o, calma e prevenÃ§Ã£o de crises.</p>
  </header>

  <!-- CONTEÃšDO PRINCIPAL -->
  <main class="container">

    <!-- Idioma -->
    <label>ğŸŒ Idioma:</label>
    <select id="idioma">
      <option value="pt-PT">PortuguÃªs</option>
      <option value="en-US">English</option>
    </select>

    <!-- Entrada -->
    <label>ğŸ’¬ Digite ou fale:</label>
    <input type="text" id="entrada" placeholder="Ex: Quero brincar..." />

    <div class="btn-row">
      <button onclick="falarTexto()">ğŸ”Š Falar Texto</button>
      <button onclick="capturarVoz()">ğŸ™ï¸ Microfone</button>
    </div>

    <!-- Pictogramas -->
    <div class="pictogramas">
      <div class="pictograma" onclick="usar('Quero comer')">ğŸ½ï¸ Comer</div>
      <div class="pictograma" onclick="usar('Preciso de silÃªncio')">ğŸ”‡ SilÃªncio</div>
      <div class="pictograma" onclick="usar('Quero brincar')">ğŸ§¸ Brincar</div>
      <div class="pictograma" onclick="usar('Estou triste')">ğŸ˜¢ Triste</div>
      <div class="pictograma" onclick="usar('Estou feliz')">ğŸ˜Š Feliz</div>
      <div class="pictograma" onclick="usar('Estou com dor')">ğŸ¤• Dor</div>
    </div>

    <div id="saida"></div>

    <!-- ALERTA DE CRISE -->
    <div id="alertaCrise">
      âš ï¸ ALTO RISCO DETECTADO â€” Ativando modo Calmaâ€¦
    </div>

    <!-- SessÃ£o de respiraÃ§Ã£o -->
    <div id="respiracaoGuiada">
      <h3>ğŸ« RespiraÃ§Ã£o Guiada</h3>
      <p id="faseResp"></p>
    </div>

  </main>

  <!-- LIGAÃ‡ÃƒO AOS MOTORES -->
  <script type="module" src="app.js"></script>

  <!-- SCRIPT PRINCIPAL DA INTERFACE -->
  <script>
    function toggleMenu() {
      document.getElementById("sideMenu").classList.toggle("open");
    }

    function abrirVersao(id) {
      alert("Funcionalidade pronta para receber links reais em produÃ§Ã£o: " + id);
    }

    function usar(t) {
      document.getElementById("entrada").value = t;
      processar();
    }

    function falarTexto() {
      const texto = document.getElementById("entrada").value;
      processar(texto);
    }

    function capturarVoz() {
      const rec = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      rec.lang = document.getElementById("idioma").value;
      rec.start();

      rec.onresult = e => {
        const txt = e.results[0][0].transcript;
        document.getElementById("entrada").value = txt;
        processar(txt);
      };
    }

    // PROCESSAMENTO (liga Ã  Tecla Engine)
    function processar() {
      const texto = document.getElementById("entrada").value;
      const resultado = window.Tecla.ecp.processar(texto);

      document.getElementById("saida").innerText =
        `Tecla: "${texto}"\nRisco detectado: ${Math.round(resultado.risco * 100)}%`;

      if (resultado.risco >= 0.6) {
        document.getElementById("alertaCrise").style.display = "block";
      } else {
        document.getElementById("alertaCrise").style.display = "none";
      }
    }

    // RESPIRAÃ‡ÃƒO GUIADA â€“ ativada automaticamente pelo Engine
    window.addEventListener("tecla-breathing-start", () => {
      iniciarRespiracao();
    });

    function iniciarRespiracao() {
      const fase = document.getElementById("faseResp");
      const box = document.getElementById("respiracaoGuiada");
      box.style.display = "block";

      let ciclos = ["Inspireâ€¦", "Segureâ€¦", "Expire lentamenteâ€¦"];
      let i = 0;

      const loop = setInterval(() => {
        fase.innerText = ciclos[i];
        i++;

        if (i >= ciclos.length) i = 0;
      }, 3000);

      setTimeout(() => {
        clearInterval(loop);
        box.style.display = "none";
      }, 15000);
    }
  </script>

</body>
</html>

