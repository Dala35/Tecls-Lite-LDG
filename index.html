<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tecla Premium - Respira√ß√£o Guiada</title>
<style>
  body { margin:0; font-family: Arial, sans-serif; background:#f4f7fa; }
  .sidebar { position: fixed; left:0; top:0; width:240px; height:100%; background:#34495e; color:white; padding-top:20px; }
  .sidebar h2 { text-align:center; margin-bottom:30px; }
  .sidebar a { display:block; padding:15px; color:white; text-decoration:none; margin:5px 0; border-radius:4px; }
  .sidebar a:hover { background:#2c3e50; }
  .main { margin-left:260px; padding:20px; }
  .header { display:flex; justify-content: space-between; align-items:center; margin-bottom:20px; }
  .header h1 { margin:0; font-size:24px; }
  .alert { padding:10px; background:#e74c3c; color:white; margin-bottom:10px; border-radius:5px; }
  .card { background:white; padding:20px; border-radius:8px; margin-bottom:20px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
  table { width:100%; border-collapse: collapse; }
  th, td { padding:10px; border-bottom:1px solid #ddd; text-align:left; }
  input[type="text"] { width: 100%; padding:10px; margin-top:10px; font-size:16px; border:1px solid #ccc; border-radius:6px; }
  button { padding:10px 20px; margin-top:10px; border:none; background:#4b9cd3; color:white; border-radius:6px; cursor:pointer; font-size:16px; }
  canvas { background:white; border-radius:8px; padding:10px; }
  .barras { display:flex; justify-content:space-between; margin-top:20px; }
  .barra { background:#3498db; color:white; padding:10px; border-radius:6px; flex:1; margin:0 5px; text-align:center; cursor:pointer; transition:0.2s; }
  .barra:hover { background:#2980b9; }
  .respiracao { text-align:center; font-size:24px; margin-top:20px; }
</style>
</head>
<body>

<div class="sidebar">
  <h2>Tecla Premium</h2>
  <a href="#dashboard">Dashboard</a>
  <a href="#logs">Logs</a>
  <a href="#config">Configura√ß√µes</a>
  <a href="#versoes">Vers√µes</a>
  <a href="#bio">Biometria</a>
  <a href="#resp">Respira√ß√£o Guiada</a>
</div>

<div class="main">
  <div class="header">
    <h1>Dashboard Interativo Avan√ßado</h1>
    <div>üë§ Terapeuta</div>
  </div>

  <!-- Entrada de frases -->
  <div class="card">
    <h3>Entrada de Frase</h3>
    <input type="text" id="entrada" placeholder="Digite a frase ou desejo da crian√ßa">
    <button onclick="processarEntrada()">Enviar</button>
  </div>

  <!-- Alertas -->
  <div id="alertas"></div>

  <!-- Logs -->
  <div class="card" id="logs">
    <h3>Logs Detalhados</h3>
    <table>
      <thead>
        <tr><th>Hor√°rio</th><th>Frase</th><th>Categoria</th><th>Alerta</th><th>Frequ√™ncia</th><th>Respira√ß√£o</th></tr>
      </thead>
      <tbody id="tabelaLogs"></tbody>
    </table>
  </div>

  <!-- Gr√°fico de Emo√ß√µes -->
  <div class="card">
    <h3>Resumo de Emo√ß√µes</h3>
    <canvas id="graficoEmocoes" width="400" height="200"></canvas>
  </div>

  <!-- Gr√°fico de Sinais Biom√©tricos -->
  <div class="card" id="bio">
    <h3>Sinais Biom√©tricos Simulados</h3>
    <canvas id="graficoBio" width="400" height="200"></canvas>
  </div>

  <!-- Tr√™s Barras de Vers√µes -->
  <div class="card" id="versoes">
    <h3>Vers√µes da Tecla</h3>
    <div class="barras">
      <div class="barra" onclick="abrirVersao('https://exemplo.com/tecla_free.html')">Gr√°tis</div>
      <div class="barra" onclick="abrirVersao('https://exemplo.com/tecla_standard.html')">Standard</div>
      <div class="barra" onclick="abrirVersao('https://exemplo.com/tecla_premium.html')">Premium</div>
    </div>
  </div>

  <!-- Respira√ß√£o Guiada -->
  <div class="card" id="resp">
    <h3>Respira√ß√£o Guiada</h3>
    <div class="respiracao" id="respiracao">Aguardando alerta...</div>
    <button onclick="iniciarRespiracao()">Iniciar Exerc√≠cio</button>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Dados simulados
let dadosLogs = [];
const alertasDiv = document.getElementById('alertas');

// Fun√ß√£o simples de predi√ß√£o de crise com biometria
function predicaoCrise(frase, freqCard, resp) {
  const palavrasRisco = ['triste', 'dor', 'irritado', 'assustado', 'medo'];
  const alertaFrase = palavrasRisco.some(p => frase.toLowerCase().includes(p));
  const alertaBio = freqCard > 110 || resp > 25; // sinais de estresse
  return alertaFrase || alertaBio;
}

// Fun√ß√£o de categoriza√ß√£o
function categorizar(frase) {
  const palavrasBrincar = ['brincar','jogar','divertir'];
  const palavrasComer = ['comer','lanche','alimentar'];
  const palavrasBanheiro = ['banheiro','ir ao banheiro'];
  const palavrasFeliz = ['feliz','contente','sorrir'];
  const palavrasTriste = ['triste','chorar','infeliz'];
  
  for(let p of palavrasBrincar) if(frase.toLowerCase().includes(p)) return 'Brincar';
  for(let p of palavrasComer) if(frase.toLowerCase().includes(p)) return 'Necessidade';
  for(let p of palavrasBanheiro) if(frase.toLowerCase().includes(p)) return 'Necessidade';
  for(let p of palavrasFeliz) if(frase.toLowerCase().includes(p)) return 'Feliz';
  for(let p of palavrasTriste) if(frase.toLowerCase().includes(p)) return 'Triste';
  return 'Neutro';
}

// Processa entrada do usu√°rio
function processarEntrada() {
  const entrada = document.getElementById('entrada').value;
  if(!entrada) return;

  const hora = new Date().toLocaleTimeString();
  const categoria = categorizar(entrada);

  // Biometrics simulados
  const freqCard = Math.floor(Math.random() * 50) + 80; // 80-130 bpm
  const resp = Math.floor(Math.random() * 15) + 10;     // 10-25 respira√ß√µes/min

  const alerta = predicaoCrise(entrada, freqCard, resp);

  // Salvar no log
  dadosLogs.push({hora, frase:entrada, categoria, alerta, freqCard, resp});
  atualizarLogs();
  atualizarGrafico();
  atualizarBio();

  // Exibir alerta
  if(alerta){
    const div = document.createElement('div');
    div.className = 'alert';
    div.innerText = `‚ö†Ô∏è Alerta de poss√≠vel crise: "${entrada}" √†s ${hora} (Freq: ${freqCard} bpm, Resp: ${resp})`;
    alertasDiv.appendChild(div);
    falar(`Alerta! Poss√≠vel crise detectada: ${entrada}`);
    iniciarRespiracao(); // Inicia respira√ß√£o guiada automaticamente
  }

  document.getElementById('entrada').value='';
}

// Atualiza tabela de logs
function atualizarLogs() {
  const tabela = document.getElementById('tabelaLogs');
  tabela.innerHTML = '';
  dadosLogs.forEach(log=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${log.hora}</td><td>${log.frase}</td><td>${log.categoria}</td><td>${log.alerta ? '‚ö†Ô∏è' : ''}</td><td>${log.freqCard}</td><td>${log.resp}</td>`;
    tabela.appendChild(tr);
  });
}

// Fala em voz alta
function falar(texto) {
  const synth = window.speechSynthesis;
  const utterThis = new SpeechSynthesisUtterance(texto);
  utterThis.lang = 'pt-PT';
  synth.speak(utterThis);
}

// Gr√°fico de Emo√ß√µes
const ctxEmocoes = document.getElementById('graficoEmocoes').getContext('2d');
const graficoEmocoes = new Chart(ctxEmocoes, {
  type: 'bar',
  data: {
    labels: ['Feliz', 'Triste', 'Brincar', 'Necessidade', 'Neutro'],
    datasets: [{
      label: 'Ocorr√™ncias',
      data: [0,0,0,0,0],
      backgroundColor: ['#2ecc71','#e74c3c','#3498db','#f1c40f','#95a5a6']
    }]
  },
  options: { responsive:true, plugins:{ legend:{ display:false } } }
});

function atualizarGrafico() {
  const contagem = {Feliz:0, Triste:0, Brincar:0, Necessidade:0, Neutro:0};
  dadosLogs.forEach(log => contagem[log.categoria]++);
  graficoEmocoes.data.datasets[0].data = Object.values(contagem);
  graficoEmocoes.update();
}

// Gr√°fico de biometria
const ctxBio = document.getElementById('graficoBio').getContext('2d');
const graficoBio = new Chart(ctxBio, {
  type:'line',
  data: { labels:[], datasets:[
    {label:'Frequ√™ncia Card√≠aca (bpm)', data:[], borderColor:'#e74c3c', fill:false},
    {label:'Respira√ß√£o (rpm)', data:[], borderColor:'#3498db', fill:false}
  ]},
  options:{ responsive:true, plugins:{ legend:{ display:true } } }
});

function atualizarBio() {
  const hora = new Date().toLocaleTimeString();
  graficoBio.data.labels.push(hora);
  graficoBio.data.datasets[0].data.push(dadosLogs[dadosLogs.length-1].freqCard);
  graficoBio.data.datasets[1].data.push(dadosLogs[dadosLogs.length-1].resp);

  if(graficoBio.data.labels.length>10){
    graficoBio.data.labels.shift();
    graficoBio.data.datasets.forEach(d => d.data.shift());
  }
  graficoBio.update();
}

// Fun√ß√£o abrir vers√£o em nova aba
function abrirVersao(url) {
  window.open(url, '_blank');
}

// Respira√ß√£o guiada
let respInterval;
function iniciarRespiracao() {
  const el = document.getElementById('respiracao');
  let fase = 0; // 0: inspirar, 1: segurar, 2: expirar
  let contador = 4;

  clearInterval(respInterval);
  el.innerText = 'Preparar...';

  setTimeout(() => {
    respInterval = setInterval(() => {
      if(fase === 0){ el.innerText = `Inspire: ${contador}`; contador--; if(contador===0){fase=1; contador=2;} }
      else if(fase ===1){ el.innerText = `Segure: ${contador}`; contador--; if(contador===0){fase=2; contador=6;} }
      else if(fase ===2){ el.innerText = `Expire: ${contador}`; contador--; if(contador===0){fase=0; contador=4;} }
    }, 1000);
  }, 2000);
}
</script>

</body>
</html>
